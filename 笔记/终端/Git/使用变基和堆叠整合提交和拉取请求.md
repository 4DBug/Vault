## 为什么用堆叠提交和变基？

### 都有什么操作模式？

如果使用 GitHub 默认的拉取请求合并模式，将会发生下面的步骤

1. 把我们目前的提交全部放到合并的基准分支（如果拉取请求是从 dev 合并到 main 的话，则 main 分支就是基准分支）里面
2. 连带创建一个新的提交说明本次合并的来源分支和基准分支

#### 好处

1. 简单易用，不需要掌握复杂的 git 命令就可以直接执行，现有的绝大多数自动化工具在本地也是这样合并的
2. 可以保留每一个 PR 的独立提交的变更和提交信息

#### 坏处

1. 如果开发人员不好好整理提交信息，将会有大量的垃圾提交信息和重复无用的提交记录（比如提交 1 改了某个地方，提交 2 又改回去）被同步到主分支上，造成管理混乱
2. 回滚的时候也会遇到很多麻烦
3. 每次都会多一条「合并提交: 从 xxx 到 xxx 的合并」这样的提交记录，如果在多个分支、多个拉取请求中维护代码，最终合并到主分支上的时候都会多很多这样的一条垃圾信息（但其实是完全可以合并的）
4. 协同开发的时候每次都会多各种乱糟糟的提交信息

### 堆叠并合并模式

这个也是其中一种 GitHub 拉取请求中的合并模式，将会发生以下步骤

1. 我们所有的提交（在同一个 PR 中的）都会被堆叠为一个提交，合并前的每一条记录都会自动写入到堆叠后的提交信息的详细说明中
2. 把这个提交放到合并的基准分支（如果拉取请求是从 dev 合并到 main 的话，则 main 分支就是基准分支）里面
3. 一般而言，会删除合并用的分支

#### 好处

1. 可以重新整理我们的提交信息和提交记录，整合好之后，可以根据功能块分类提交
2. 美观，整洁
3. 无论开发人员如何提交，最终都会变成一条提交记录
4. 协同开发的时候除非遭遇冲突，否则不用一直去同步别人的分支，只需要和主分支保持同步即可

#### 坏处

1. 依然会创建额外的提交信息，一般使用 PR 的标题作为这一条提交的信息进行提交
2. 同步和更新会变得更困难
3. 回滚的时候无论是回滚拉取请求还是会滚提交，都是等效的
4. 提交、贡献数量都不会被完整保留，一个 PR 只产生一条提交

### 变基合并模式

这个也是其中一种 GitHub 拉取请求中的合并模式，将会发生以下步骤

1. 把我们所有的提交（在同一个 PR 中的）全部原位放到基准分支里面

#### 好处

1. 操作起来没有难度，可以完整保留提交记录
2. 不会多任何的额外提交记录

#### 坏处

1. 如果开发人员不好好整理提交信息，将会有大量的垃圾提交信息和重复无用的提交记录（比如提交 1 改了某个地方，提交 2 又改回去）被同步到主分支上，造成管理混乱
2. 回滚的时候也会遇到很多麻烦
3. 同步和更新会变得更困难



zong shan